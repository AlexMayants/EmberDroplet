"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e,t){var n={NONE:0,VALID:1,INVALID:2,DELETED:4,UPLOADED:8,FAILED:16},r=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,e),this.file=t,this.statusType=n.NONE}return _createClass(e,[{key:"getMIMEType",value:function(){return this.file.type}},{key:"setStatusType",value:function(e){this.statusType=Number(e)}}]),e}(),i={PUSH:"push",SET:"set"},s=t.String.w("files.length","files.@each.statusType"),u={URL_REQUIRED:"Droplet: You must specify the URL parameter when constructing your component."};e.Droplet=t.Mixin.create({url:function(){throw new Error(u.URL_REQUIRED)},hooks:{didAdd:function(){},didDelete:function(){},didUpload:function(){}},files:[],model:r,mimeTypes:["image/jpeg","image/jpg","image/gif","image/png","image/tiff","image/bmp"],statusTypes:n,init:function(){t.set(this,"files",[]),this._super()},uploadStatus:t.computed(function(){return{uploading:!1,percentComplete:0,error:!1}}),validFiles:t.computed(function(){return this.getFiles(n.VALID)}).property(s),invalidFiles:t.computed(function(){return this.getFiles(n.INVALID)}).property(s),deleteFiles:t.computed(function(){return this.getFiles(n.DELETED)}).property(s),getFiles:function(e){return this.files.filter(function(t){return t.statusType&e})},actions:{uploadFiles:function(){var e=this,r=function(n){return"function"==typeof t.get(e,"url")},i=(r(t.get(this,"url"))?t.get(this,"url").apply(this):t.get(this,"url"),t.get(this,"files").filter(function(e){return e.statusType&n.VALID}));return new t.RSVP.Promise(function(e,t){e({files:i})}).then(function(n){var r;(r=t.get(e,"hooks")).didUpload.apply(r,_toConsumableArray(n.files))},function(e,t,n){})},mimeTypes:function(e){var n=arguments.length<=1||void 0===arguments[1]?i.PUSH:arguments[1];n===i.SET&&t.set(this,"mimeTypes",[]),e=Array.isArray(e)?e:[e];var r=[].concat(_toConsumableArray(t.get(this,"mimeTypes")),_toConsumableArray(e));t.set(this,"mimeTypes",r)},addFiles:function(){for(var e,i=this,s=function(e){return!!~t.get(i,"mimeTypes").indexOf(e)},u=arguments.length,o=Array(u),a=0;u>a;a++)o[a]=arguments[a];var l=o.map(function(e){return e instanceof r?(e.setStatusType(s(e.getMIMEType())?n.VALID:n.INVALID),t.get(i,"files").pushObject(e),e):void 0}).filter(function(e){return"undefined"!=typeof e});l.length&&(e=t.get(this,"hooks")).didAdd.apply(e,_toConsumableArray(l))},deleteFiles:function(){for(var e,i=this,s=arguments.length,u=Array(s),o=0;s>o;o++)u[o]=arguments[o];var a=u.map(function(e){var s=!!~t.get(i,"files").indexOf(e);return s&&e instanceof r?(e.setStatusType(n.DELETED),t.get(i,"files").removeObject(e),e):void 0}).filter(function(e){return"undefined"!=typeof e});a.length&&(e=t.get(this,"hooks")).didDelete.apply(e,_toConsumableArray(a))},clearFiles:function(){var e=this;this.files.forEach(function(t){return e.send("deleteFiles",t)}),this.files.length=0}}})}(window,window.Ember);